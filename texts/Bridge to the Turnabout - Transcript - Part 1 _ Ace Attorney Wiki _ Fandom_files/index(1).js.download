/*! For license information please see index.js.LICENSE.txt */
(()=>{var t,e,n={28:t=>{function e(t,e){return Object.keys(e).forEach((function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})})),t}function n(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}n(t.exports,"utils",(()=>i));var i={},o={};function r(t){return new Promise((e=>setTimeout((()=>e()),t)))}n(o,"delay",(()=>r));var s={};function a(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}n(s,"getDebugGroup",(()=>a));var c={};n(c,"localStorageHelper",(()=>u));class u{constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let n=!1;try{n=void 0!==window.localStorage&&null!==window.localStorage,n&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){n=!1}const i=t=>window?.instantConfigCache?.[t]??null,o=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return n?window.localStorage.getItem(t)??i(t):i(t)}catch(e){return i(t)}},setItem:(t,e)=>{try{if(n)return localStorage.setItem(t,e);o(t,e)}catch(n){o(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var d={};n(d,"lock",(()=>h)),n(d,"release",(()=>p));const l=new u("instant-config-lock",1e3);function h(){return"lock"===l.get()||(l.set("lock"),!1)}function p(){l.set(null)}var f={};n(f,"getTimeDelta",(()=>m)),n(f,"logger",(()=>w)),n(f,"warner",(()=>b));const g=a()||"",v=g.split(","),y=Date.now();function m(){return((Date.now()-(window.performance?.timeOrigin??y))/1e3).toFixed(4)}function w(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.info(`${m()}s\t\t ${t}`,e))}function b(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.warn(t,e))}e(i,s),e(i,c),e(i,f),e(i,o),e(i,d);var C={},j={};n(j,"EmptyInstantConfigCacheStorage",(()=>O));class O{get(t){}set(t){}remove(t){}}var S={};n(S,"InstantConfigInterpreter",(()=>q));var k={},Q={};n(Q,"BrowserMatcher",(()=>G));var T={};n(T,"extractNegation",(()=>x));var E={},I={};function R(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}n(I,"shouldBeListOfConfigGroups",(()=>R));var _={};n(_,"negativePrefix",(()=>A)),n(_,"cacheSuffix",(()=>P)),n(_,"samplingSeparator",(()=>W)),n(_,"worldWide",(()=>M)),n(_,"precision",(()=>D));const A="non-",P="-cached",W="/",M="XX",D=10**6;function x(t){return t.startsWith(A)?{value:t.replace(A,""),negated:!0}:{value:t,negated:!1}}e(E,{}),e(E,{}),e(E,{}),e(E,I),e(E,{}),e(E,{}),e(E,{}),e(E,{}),e(E,{}),e(E,_);class G{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t=[]){const e=t.map((t=>t.toLowerCase())).map((t=>x(t)));return 0===t.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,e)&&e.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var L={};n(L,"DeviceMatcher",(()=>N));class N{constructor(t){this.currentDevice=t}isValid(t=[]){const e=t.map((t=>t.toLowerCase())).map((t=>x(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var V={};n(V,"DomainMatcher",(()=>U));class U{isValid(t=[]){return 0===t.length||t.some((t=>window.location.hostname.includes(t)))}}var H={};n(H,"RegionMatcher",(()=>F));class F{constructor(t){this.geo=t}isValid(t=[],e){const n=this.filterOutInvalidRegions(t);return e?e(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(W))).filter((t=>!t.includes(P)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${M}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(M)>-1||this.isSampledForGeo(t,M)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${A}${this.getCountryCode()}`)>-1||t.indexOf(`${A}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${A}${M}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(A)&&e.indexOf(t+W)>-1}getSamplingLimits(t){let[,e]=t.split(W);return e=e.replace(P,""),Math.round(parseFloat(e)*D)||0}isSampledForGeo(t,e){const n=t.filter(this.hasSampling(e));if(0===n.length)return!1;const i=Math.round(Math.random()*(100*D))||0;return n.map((t=>this.getSamplingLimits(t))).some((t=>i<t))}}var $={};n($,"SamplingCacheManager",(()=>B));class B{constructor(t){this.cacheStorage=t,this.precision=10**6}apply(t,e,n){const i=this.cacheStorage.get(t);if(void 0!==i){if(this.isCachedValueValid(i,e))return i.result;this.cacheStorage.remove(t)}const o=n();if("number"!=typeof e.sampling||!1===o)return o;const r=this.getSamplingResult(e.sampling),s={name:t,result:r,withCookie:Boolean(e.samplingCache),group:r?"B":"A",limit:this.getLimit(r,e.sampling)};return this.cacheStorage.set(s),r}getSamplingResult(t){const e=Math.round(100*Math.random()*this.precision);return Math.round(t*this.precision)>e}isCachedValueValid(t,e){return e.samplingCache&&"number"==typeof e.sampling&&t.limit==this.getLimit(t.result,e.sampling)}getLimit(t,e){return+(t?e:100-e).toFixed(6)}}e(k,Q),e(k,L),e(k,V),e(k,T),e(k,H),e(k,$);class q{constructor(t=new G,e=new N,n=new U,i=new F,o=new O){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=n,this.regionMatcher=i,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new B(o)}init(t,e={},n){return this.configResponse={...e,...t},this.regionValidationPredicate=n,this}getValues(){return i.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map((t=>({key:t,value:this.configResponse[t]}))).map((({key:t,value:e})=>R(e)?{key:t,value:this.getValue(t,e)}:{key:t,value:e})).reduce(((t,e)=>({...t,[e.key]:e.value})),{})}getValue(t,e){const n=e.find(((e,n)=>this.samplingCache.apply(`${t}-${n}`,e,this.getPredicate(e))));if(void 0!==n)return n.value}getPredicate(t){return()=>this.browserMatcher.isValid(t.browsers)&&this.deviceMatcher.isValid(t.devices)&&this.domainMatcher.isValid(t.domains)&&this.regionMatcher.isValid(t.regions,this.regionValidationPredicate)}}var z={};async function Y(t,e=2e3){const n=new AbortController,i=setTimeout((()=>n.abort()),e),o=await fetch(t,{signal:n.signal});return clearTimeout(i),o}n(z,"InstantConfigLoader",(()=>Z));const K="instant-config-loader",J="instantConfig",X={b:"browsers",d:"devices",s:"sampling",c:"samplingCache",r:"regions",v:"value"};class Z{constructor(t,e=window){this.params=t,this.configPromise=null,this.storage=new i.localStorageHelper(`instant-config-${t.appName}`,6e4),this.instantConfig=this.fromContainer(e)}async getConfig(){return this.instantConfig?this.instantConfig:(this.configPromise||(this.configPromise=this.fetchInstantConfig().then((t=>t??this.fetchFallbackConfig()))),this.configPromise.then((t=>t)))}async fetchInstantConfig(t=!1){if(i.lock()&&!t)return await r(500),this.fetchInstantConfig(!0);const e=`${this.params.instantConfigEndpoint??"https://services.fandom.com"}/${this.params.instantConfigVariant??"icbm"}/api/config?app=${this.params.appName}`;try{const t=this.storage.get();if(t)return i.logger(K,"instant config pulled from local storage",t),JSON.parse(t);const n=await Y(e,this.params.requestTimeout);if(!n.ok)return;const o=await n.json();return this.storage.set(JSON.stringify(o)),i.release(),i.logger(K,"instant config fetched",o),o}catch(t){return i.warner(K,"could not fetch instant config",t),void i.release()}}async fetchFallbackConfig(){i.logger(K,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{i.logger(K,t);const e=await Y(t,this.params.requestTimeout);if(!e.ok)return{};const n=await e.json();return i.logger(K,"fallback config fetched",n),n}catch(t){return i.warner(K,"could not fetch fallback config",t),{}}}fromContainer(t){let e=t[J];return"object"!=typeof e||e._ready||(Object.keys(e).forEach((t=>{const n=e[t];R(n)&&(e[t]=n.map((t=>Object.fromEntries(Object.entries(t).map((([t,e])=>[X[t]?X[t]:t,e]))))))})),e._ready=!0,t[J]=e),e}}var tt={};n(tt,"InstantConfigOverrider",(()=>nt));const et=["InstantGlobals","icbm"];class nt{override(t,e){return[...t.keys()].filter((t=>{return e=t,et.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:n})=>({key:n,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:n})=>({...t,[e]:n})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}e(C,j),e(C,S),e(C,z),e(C,tt),e(C,k),e(t.exports,C),e(t.exports,E)},606:t=>{var e,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:r}catch(t){n=r}}();var a,c=[],u=!1,d=-1;function l(){u&&a&&(u=!1,a.length?c=a.concat(c):d=-1,c.length&&h())}function h(){if(!u){var t=s(l);u=!0;for(var e=c.length;e;){for(a=c,c=[];++d<e;)a&&a[d].run();d=-1,e=c.length}a=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||u||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},155:(t,e,n)=>{"use strict";n.d(e,{r:()=>i});class i{constructor(t,e){this.__global=!0,this.timestamp=Date.now(),this.name=t.name,this.category=t.category||"[Identity]",this.type=`${this.category} ${t.name}`,Object.assign(this,e)}}},85:(t,e,n)=>{"use strict";n.d(e,{U:()=>S});var i=n(635),o=function(){return o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},r={channelId:"default",host:window,coordinatorHost:window.top},s={connect:"connect",connected:"connected"},a="@wikia/post-quecast";function c(t){return t.channelId&&t.libId===a&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function u(t){return!t.data.private}function d(t,e){return t.data.channelId===e}function l(t){return t.data.action}var h=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[a])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[a].callbackConnector:new f({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),p=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(n){return n({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),f=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var n;(n=e)&&n.source&&n.data&&c(n.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),g=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=h.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(n){if(d(n,t.channelId)&&function(t){return!!t.data.private}(n)){var i=l(n);(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.type===e}))})(i,s.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,i.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(d(e,t.channelId)&&u(e)){var n=l(e);t.handleActions(n)}}))},t.prototype.handleActions=function(){for(var t,e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];(t=this.history).push.apply(t,n),n.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:s.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:a})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),v=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.channelId=e.channelId,this.connector=h.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:o(o({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:a})},t}(),y=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.transmitter=new v(e),this.receiver=new g(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),m=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[a].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:a})},t.prototype.createConnectedAction=function(){return{type:s.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(n){n.dispatch({action:t,channelId:e.channelId,libId:a})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new f({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),w=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new p(t),this.postMessageConnector=new f({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){u(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.data.action.type===e}))})(t,s.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(s).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new m(t,this.coordinatorHost)),this.channels.get(t)},t}();function b(t){if(void 0===t&&(t=window),!t[a]){var e=new w(t);e.init(),t[a]=e}}var C,j=n(223),O=n(393);let S=class{constructor(t){this.window=t,this.history=new Map;const{channelId:e,coordinatorName:n}=this.getSettings();b(),this.communicator=new y({channelId:e||"default",coordinatorHost:t[n]||top})}emit(t){this.communicator.dispatch(t)}on(t,e){this.communicator.addListener((n=>this.run(n,t,e)))}once(t,e){this.communicator.addListener((n=>this.runOnce(n,t,e)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(t,e,n){this.ofType(t,e)&&n(t)}runOnce(t,e,n){const i=e.category+" "+e.name;this.ofType(t,e)&&(this.history.has(i)||(this.history.set(i,!0),n(t)))}ofType(t,e){return t.category===e.category&&t.name===e.name||t.type===e.category+" "+e.name}};S=(0,i.Cg)([(0,j.Gr)(),(0,i.Qj)(0,(0,j.WQ)(O.jf)),(0,i.Sn)("design:paramtypes",["function"==typeof(C="undefined"!=typeof Window&&Window)?C:Object])],S)},349:(t,e,n)=>{"use strict";n.d(e,{c:()=>i});const i={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},CONSENT_UPDATE:{category:"[AdEngine OptIn]",name:"update opt in"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},PAGE_CHANGED:{name:"Page changed",category:"[Platform]"},INSTANT_CONFIG_CACHE_READY:{category:"[AdEngine]",name:"Instant Config cache ready"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}}},841:(t,e,n)=>{"use strict";n.d(e,{X:()=>pt});var i,o,r,s=n(635),a=n(223),c=n(144),u=n(858),d=n(439),l=n(538),h=n(610);let p=class{constructor(t,e,n){this.adsContext=t,this.platform=e,this.device=n,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){var t,e;const n=this.platform.get(),i="desktop"===this.device.getDeviceType()?"desktop":"mobile";return(null===(t=this.adsContext.get())||void 0===t?void 0:t.skin)?`${null!==(e=this.adsContext.get().skin)&&void 0!==e?e:n}_${i}`:this.skinMap[n]?this.skinMap[n]+"_"+i:"unknown"}};p=(0,s.Cg)([(0,a.Gr)(),(0,s.Qj)(0,(0,a.WQ)(h.i)),(0,s.Qj)(1,(0,a.WQ)(d.O)),(0,s.Qj)(2,(0,a.WQ)(l.p)),(0,s.Sn)("design:paramtypes",["function"==typeof(i=void 0!==h.i&&h.i)?i:Object,"function"==typeof(o=void 0!==d.O&&d.O)?o:Object,"function"==typeof(r=void 0!==l.p&&l.p)?r:Object])],p);var f=n(167),g=n(695),v=n(546);let y=class{constructor(){this.operatingSystem=null}getOperatingSystem(){if(null!==this.operatingSystem)return this.operatingSystem;const{userAgent:t}=window.navigator;return this.operatingSystem="unknown",-1!==t.indexOf("Win")&&(this.operatingSystem="Windows"),-1!==t.indexOf("Mac")&&(this.operatingSystem="OSX"),-1!==t.indexOf("Linux")&&(this.operatingSystem="Linux"),-1!==t.indexOf("Android")&&(this.operatingSystem="Android"),-1!==t.indexOf("like Mac")&&(this.operatingSystem="iOS"),this.operatingSystem}};y=(0,s.Cg)([(0,a.Gr)()],y);var m=n(712),w=n(393);class b{constructor(t,e,n,i,o,r,s,a,c,u){this.logger=t,this.httpClient=e,this.skin=n,this.optInService=i,this.window=o,this.wikiConfig=r,this.geo=s,this.browser=a,this.operatingSystem=c,this.dataWarehouseUrl=u,this.initStartTime()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}getCurrentTimestamp(){return Date.now()}initStartTime(){const t=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=t.getTimezoneOffset())}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}getTrackingParams(){var t,e,n,i,o,r,s,a,c,u,d,l,h;return{browser:`${this.operatingSystem.getOperatingSystem()} ${this.browser.getBrowser()}`,browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvNumber,pv_number_global:null===(r=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===r?void 0:r.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(u=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===u?void 0:u.beaconId,ua:null===(d=this.window.navigator)||void 0===d?void 0:d.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(l=this.window.fandomContext)||void 0===l?void 0:l.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}generateBaseParams(t){return Object.assign(Object.assign(Object.assign({},t),this.getTimeBasedParams()),this.getTrackingParams())}buildDataWarehouseUrl(t,e){if(!e)return void this.logger.error("Error building DWH tracking URL");const n=new URLSearchParams(t);return n.sort(),`${e}?${n.toString()}`}sendEvent(t,e){const n=this.generateBaseParams(t),i=this.buildDataWarehouseUrl(n,e);i&&this.httpClient.get(i)}}var C,j,O,S,k,Q,T,E,I;let R=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/identityinfo")}send(t){this.sendEvent(t,this.dataWarehouseUrl)}};R=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(u.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(C=void 0!==c.V&&c.V)?C:Object,"function"==typeof(j=void 0!==u.Q&&u.Q)?j:Object,"function"==typeof(O=void 0!==p&&p)?O:Object,"function"==typeof(S=void 0!==m.E&&m.E)?S:Object,"function"==typeof(k="undefined"!=typeof Window&&Window)?k:Object,"function"==typeof(Q=void 0!==f.j&&f.j)?Q:Object,"function"==typeof(T=void 0!==g.u&&g.u)?T:Object,"function"==typeof(E=void 0!==v.P&&v.P)?E:Object,"function"==typeof(I=void 0!==y&&y)?I:Object])],R);var _,A,P,W,M,D,x,G,L,N=n(489);let V=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/adengloadtimes")}send(t){this.sendEvent({event_name:t,load_time:this.getCurrentTimestamp()-this.getStartTime()},this.dataWarehouseUrl)}};var U,H,F,$,B,q,z,Y,K;V=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(u.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(_=void 0!==c.V&&c.V)?_:Object,"function"==typeof(A=void 0!==u.Q&&u.Q)?A:Object,"function"==typeof(P=void 0!==p&&p)?P:Object,"function"==typeof(W=void 0!==m.E&&m.E)?W:Object,"function"==typeof(M="undefined"!=typeof Window&&Window)?M:Object,"function"==typeof(D=void 0!==f.j&&f.j)?D:Object,"function"==typeof(x=void 0!==g.u&&g.u)?x:Object,"function"==typeof(G=void 0!==v.P&&v.P)?G:Object,"function"==typeof(L=void 0!==y&&y)?L:Object])],V);let J=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/chromelabels")}send(t){this.sendEvent({event_name:"chrome_label",label:t},this.dataWarehouseUrl)}};var X,Z,tt,et,nt,it,ot,rt,st;J=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"ChromeLabelSender")),(0,s.Qj)(1,(0,a.WQ)(u.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(U=void 0!==c.V&&c.V)?U:Object,"function"==typeof(H=void 0!==u.Q&&u.Q)?H:Object,"function"==typeof(F=void 0!==p&&p)?F:Object,"function"==typeof($=void 0!==m.E&&m.E)?$:Object,"function"==typeof(B="undefined"!=typeof Window&&Window)?B:Object,"function"==typeof(q=void 0!==f.j&&f.j)?q:Object,"function"==typeof(z=void 0!==g.u&&g.u)?z:Object,"function"==typeof(Y=void 0!==v.P&&v.P)?Y:Object,"function"==typeof(K=void 0!==y&&y)?K:Object])],J);let at=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/gdpr_events")}send(t){this.sendEvent(t,this.dataWarehouseUrl)}generateBaseParams(t){return Object.assign(Object.assign({},t),this.getTrackingParams())}getTrackingParams(){var t,e;return{lang_code:this.getLanguageCode()||"unknown",detected_geo:this.geo.getCountryCode()||"",beacon:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.beaconId}}getLanguageCode(){var t,e,n;return this.wikiConfig.get("wgUserLanguage")||(null===(n=null===(e=null===(t=this.window)||void 0===t?void 0:t.navigator)||void 0===e?void 0:e.language)||void 0===n?void 0:n.toLowerCase().substring(0,2))}};var ct,ut,dt,lt,ht;at=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"ConsentsEventSender")),(0,s.Qj)(1,(0,a.WQ)(u.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(X=void 0!==c.V&&c.V)?X:Object,"function"==typeof(Z=void 0!==u.Q&&u.Q)?Z:Object,"function"==typeof(tt=void 0!==p&&p)?tt:Object,"function"==typeof(et=void 0!==m.E&&m.E)?et:Object,"function"==typeof(nt="undefined"!=typeof Window&&Window)?nt:Object,"function"==typeof(it=void 0!==f.j&&f.j)?it:Object,"function"==typeof(ot=void 0!==g.u&&g.u)?ot:Object,"function"==typeof(rt=void 0!==v.P&&v.P)?rt:Object,"function"==typeof(st=void 0!==y&&y)?st:Object])],at);let pt=class{constructor(t,e,n,i,o){this.logger=t,this.identityEventSender=e,this.loadTimeEventSender=n,this.chromeLabelSender=i,this.consentEventSender=o}track(t,e){switch(t){case N.i.identity:this.identityEventSender.send(e);break;case N.i.loadTime:this.loadTimeEventSender.send(e);break;case N.i.chromeLabel:this.chromeLabelSender.send(e);break;case N.i.consents:this.consentEventSender.send(e);break;default:this.logger.info("Invalid event type to track")}}};pt=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(R)),(0,s.Qj)(2,(0,a.WQ)(V)),(0,s.Qj)(3,(0,a.WQ)(J)),(0,s.Qj)(4,(0,a.WQ)(at)),(0,s.Sn)("design:paramtypes",["function"==typeof(ct=void 0!==c.V&&c.V)?ct:Object,"function"==typeof(ut=void 0!==R&&R)?ut:Object,"function"==typeof(dt=void 0!==V&&V)?dt:Object,"function"==typeof(lt=void 0!==J&&J)?lt:Object,"function"==typeof(ht=void 0!==at&&at)?ht:Object])],pt)},489:(t,e,n)=>{"use strict";var i;n.d(e,{i:()=>i}),function(t){t[t.identity=0]="identity",t[t.loadTime=1]="loadTime",t[t.chromeLabel=2]="chromeLabel",t[t.consents=3]="consents"}(i||(i={}))},905:(t,e,n)=>{"use strict";n.d(e,{q:()=>a});var i,o=n(635),r=n(223),s=n(144);let a=class{constructor(t){this.logger=t}addLocatorFrame(){const t="____tcfapiLocator";if(window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.body,n=document.createElement("iframe");n.name=t,n.style.display="none",e.appendChild(n)}install(){function t(t){try{let e=t.data;const n="string"==typeof e;if(n)try{e=JSON.parse(e)}catch(t){}const i=e.__tcfapiCall;i&&window.__tcfapi(i.command,i.parameter,(function(e,o){const r={__tcfapiReturn:{returnValue:e,success:o,callId:i.callId}};t.source.postMessage(n?JSON.stringify(r):r,"*")}))}catch(t){}}function e(t,e,n){"addEventListener"===t||"getTCData"===t?n({eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",displayStatus:"disabled",apiVersion:"2",tcfPolicyVersion:2,gdprApplies:!1},!0):n(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(n=>{"stub"===(null==n?void 0:n.cmpStatus)&&(window.__tcfapi=e,window.__tcfapi.msgHandler=t,window.addEventListener("message",t,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=e,window.__tcfapi.msgHandler=t,window.addEventListener("message",t,!1),this.logger.info("__tcfapi installed"))}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.MR)(s.V,s.O,"TCF")),(0,o.Sn)("design:paramtypes",["function"==typeof(i=void 0!==s.V&&s.V)?i:Object])],a)},517:(t,e,n)=>{"use strict";n.d(e,{h:()=>d,u:()=>r});var i,o,r,s=n(635),a=n(223),c=n(393),u=n(874);!function(t){t.yes="Y",t.no="N",t.na="-"}(r||(r={}));let d=class{constructor(t,e){this.cookiesManager=t,this.window=e,this.usPrivacyCookie="usprivacy",this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.explicitNotice=r.yes,this.lspaSupport=r.no}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener()}createPrivacyCookie(t=r.na){const e=this.window.location.hostname,n=u.O.extract(e),i=t===r.na?`${this.USP_API_VERSION}${r.na}${r.na}${r.na}`:`${this.USP_API_VERSION}${this.explicitNotice}${t}${this.lspaSupport}`;this.cookiesManager.set(this.usPrivacyCookie,i,{domain:n,expires:365})}consentsUpdated(t){return{gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!t.startsWith(this.CCPA_TRACKING_ALLOWED)}}uspApiMessage(t,e,n){"ping"===t?n({uspapiLoaded:!1},!0):"getQueue"===t?n(this.queue,!0):this.queue.push([t,e,n])}addLocatorFrame(){const t="__uspapi";if(this.window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.createElement("iframe");e.name=t,e.style.display="none",document.body.appendChild(e)}addUspMessageListener(){this.window.addEventListener("message",(t=>{const e=this.convertUspMessageData(t);e&&this.uspMessageHandler(e,t)}),!1)}convertUspMessageData(t){try{return("string"==typeof t.data?JSON.parse(t.data):t.data).__uspapiCall}catch(t){}}uspMessageHandler(t,e){this.window.__uspapi(t.command,t.version,((n,i)=>{const o={__uspapiReturn:{returnValue:n,success:i,callId:t.callId}};e.source.postMessage(o,"*")}))}subscribe(t){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,(e=>{(null==e?void 0:e.uspString)&&t(this.consentsUpdated(e.uspString))}))}};d=(0,s.Cg)([(0,a.Gr)(),(0,s.Qj)(0,(0,a.WQ)(c.AZ)),(0,s.Qj)(1,(0,a.WQ)(c.jf)),(0,s.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof CookiesManager&&CookiesManager)?i:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object])],d)},712:(t,e,n)=>{"use strict";n.d(e,{E:()=>S});var i,o,r,s=n(635),a=n(144),c=n(223),u=n(155),d=n(349),l=n(85),h=n(439),p=n(569),f=n(695),g=n(517),v=n(905);let y=class{constructor(t,e,n){this.logger=t,this.uspApi=e,this.tcfApi=n,this.tcfApi.install()}subscribe(t){this.logger.info("__uspapi installed"),this.uspApi.subscribe(t)}};var m,w;y=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(1,(0,c.WQ)(g.h)),(0,s.Qj)(2,(0,c.WQ)(v.q)),(0,s.Sn)("design:paramtypes",["function"==typeof(i=void 0!==a.V&&a.V)?i:Object,"function"==typeof(o=void 0!==g.h&&g.h)?o:Object,"function"==typeof(r=void 0!==v.q&&v.q)?r:Object])],y);let b=class{constructor(t,e){this.geo=t,this.platform=e,this.ONE_TRUST_PLATFORMS=[h.l.GIANTBOMB,h.l.TVGUIDE,h.l.TVGUIDE_MTC,h.l.METACRITIC_NEUTRON,h.l.METACRITIC,h.l.GAMESPOT,h.l.COMICVINE,h.l.GAMEFAQS]}shouldLoadOneTrust(){return this.ONE_TRUST_PLATFORMS.includes(this.platform.get())}get(t=!1){if(this.shouldLoadOneTrust()||t)return n.e(832).then(n.bind(n,675)).then((({OneTrustConsentStrategy:t})=>c.kL.resolve(t)));if("fanatical"===this.platform.get())return n.e(482).then(n.bind(n,341)).then((({FanaticalConsentStrategy:t})=>c.kL.resolve(t)));const e=this.geo.getCountryCode();if(e){if("us"===e)return Promise.resolve(c.kL.resolve(y));if(p.e.includes(e))return n.e(224).then(n.bind(n,904)).then((({FandomGdprConsentStrategy:t})=>c.kL.resolve(t)))}return n.e(319).then(n.bind(n,322)).then((({StaticConsentStrategy:t})=>c.kL.resolve(t)))}};var C,j,O;b=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(f.u)),(0,s.Qj)(1,(0,c.WQ)(h.O)),(0,s.Sn)("design:paramtypes",["function"==typeof(m=void 0!==f.u&&f.u)?m:Object,"function"==typeof(w=void 0!==h.O&&h.O)?w:Object])],b);let S=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(t){this._trackingAllowed=t}constructor(t,e,n){this.communicationService=t,this.logger=e,this.consentProviderFactory=n,this.consentUpdated=!1,this._trackingAllowed=!1}init(){this.consentProviderFactory.get().then((t=>t.subscribe((t=>{this.logger.info("Sending consents: ",t,"update?",this.consentUpdated),this.consentUpdated&&this.sendConsentsUpdateToAdEngine(t),this.sendConsentsToAdEngine(t),this.consentUpdated||(this.consentUpdated=!0)}))))}sendConsentsToAdEngine(t){this.communicationService.emit(new u.r(d.c.CONSENT_READY,t))}sendConsentsUpdateToAdEngine(t){this.communicationService.emit(new u.r(d.c.CONSENT_UPDATE,t))}};S=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(l.U)),(0,s.Qj)(1,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(2,(0,c.WQ)(b)),(0,s.Sn)("design:paramtypes",["function"==typeof(C=void 0!==l.U&&l.U)?C:Object,"function"==typeof(j=void 0!==a.V&&a.V)?j:Object,"function"==typeof(O=void 0!==b&&b)?O:Object])],S)},393:(t,e,n)=>{"use strict";n.d(e,{AZ:()=>i,eF:()=>s,jf:()=>o,kW:()=>a,kk:()=>r});const i=Symbol("COOKIES"),o=Symbol("WINDOW"),r=Symbol("UUID"),s=Symbol("SENTRY"),a=Symbol("NAVIGATOR")},610:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var i,o=n(635),r=n(223),s=n(393);let a=class{constructor(t){this.window=t}get(){var t;return null===(t=this.window.ads)||void 0===t?void 0:t.context}};a=(0,o.Cg)([(0,r._G)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],a)},248:(t,e,n)=>{"use strict";n.d(e,{s:()=>r});var i=n(635),o=n(223);let r=class{createScript(t,e="text/javascript",n=!0,i=null,o={},r={}){const s=document.createElement("script");if(s.async=n,s.defer=!n,s.type=e,s.src=t,Object.keys(o).forEach((t=>{s.setAttribute(t,o[t])})),Object.keys(r).forEach((t=>{s.dataset[t]=r[t]})),"string"==typeof i){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)}else(i||document.body).append(s);return s}loadScript(t,e="text/javascript",n=!0,i=null,o={},r={}){return new Promise(((s,a)=>{const c=this.createScript(t,e,n,i,o,r);c.onload=s,c.onerror=a}))}};r=(0,i.Cg)([(0,o._G)()],r)},546:(t,e,n)=>{"use strict";n.d(e,{P:()=>r});var i=n(635),o=n(223);let r=class{recognizeChromiumBuild(t,e){const n=e.match(/\b(OPR|Edg)\/(\d+)/);return null!==n?n.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):"Chrome "+t}recognizeIEBuild(t){return`IE ${(/\brv[ :]+(\d+)/g.exec(t)||[""])[1]||""}`}getBrowserNameAndVersion(t){const[,e,n]=t.match(/(opera|chrome|safari|firefox|msie|trident|CriOS(?=\/))\/?\s*(\d+)/i)||[];return[e,n]}recognizeDefaultBrowser(t,e,n,i,o){const r=o?[i,o]:[e,n,"-?"],s=t.match(/version\/(\d+)/i);return null!==s&&r.splice(1,1,s[1]),r.join(" ")}getBrowser(){const{appName:t,appVersion:e,userAgent:n}=window.navigator,[i,o]=this.getBrowserNameAndVersion(n);return/trident/i.test(i)?this.recognizeIEBuild(n):"Chrome"===i||"CriOS"===i?this.recognizeChromiumBuild(o,n):this.recognizeDefaultBrowser(n,t,e,i,o)}};r=(0,i.Cg)([(0,o.Gr)()],r)},569:(t,e,n)=>{"use strict";n.d(e,{e:()=>i});const i=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},538:(t,e,n)=>{"use strict";n.d(e,{p:()=>O});var i=n(635),o=n(223),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=window.device,a={},c=[];window.device=a;var u=window.document.documentElement,d=window.navigator.userAgent.toLowerCase(),l=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function h(t,e){return-1!==t.indexOf(e)}function p(t){return h(d,t)}function f(t){return u.className.match(new RegExp(t,"i"))}function g(t){var e=null;f(t)||(e=u.className.replace(/^\s+|\s+$/g,""),u.className=e+" "+t)}function v(t){f(t)&&(u.className=u.className.replace(" "+t,""))}function y(){a.landscape()?(v("portrait"),g("landscape"),m("landscape")):(v("landscape"),g("portrait"),m("portrait")),C()}function m(t){for(var e=0;e<c.length;e++)c[e](t)}a.macos=function(){return p("mac")},a.ios=function(){return a.iphone()||a.ipod()||a.ipad()},a.iphone=function(){return!a.windows()&&p("iphone")},a.ipod=function(){return p("ipod")},a.ipad=function(){var t="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return p("ipad")||t},a.android=function(){return!a.windows()&&p("android")},a.androidPhone=function(){return a.android()&&p("mobile")},a.androidTablet=function(){return a.android()&&!p("mobile")},a.blackberry=function(){return p("blackberry")||p("bb10")},a.blackberryPhone=function(){return a.blackberry()&&!p("tablet")},a.blackberryTablet=function(){return a.blackberry()&&p("tablet")},a.windows=function(){return p("windows")},a.windowsPhone=function(){return a.windows()&&p("phone")},a.windowsTablet=function(){return a.windows()&&p("touch")&&!a.windowsPhone()},a.fxos=function(){return(p("(mobile")||p("(tablet"))&&p(" rv:")},a.fxosPhone=function(){return a.fxos()&&p("mobile")},a.fxosTablet=function(){return a.fxos()&&p("tablet")},a.meego=function(){return p("meego")},a.cordova=function(){return window.cordova&&"file:"===location.protocol},a.nodeWebkit=function(){return"object"===r(window.process)},a.mobile=function(){return a.androidPhone()||a.iphone()||a.ipod()||a.windowsPhone()||a.blackberryPhone()||a.fxosPhone()||a.meego()},a.tablet=function(){return a.ipad()||a.androidTablet()||a.blackberryTablet()||a.windowsTablet()||a.fxosTablet()},a.desktop=function(){return!a.tablet()&&!a.mobile()},a.television=function(){for(var t=0;t<l.length;){if(p(l[t]))return!0;t++}return!1},a.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?h(screen.orientation.type,"portrait"):a.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},a.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?h(screen.orientation.type,"landscape"):a.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},a.noConflict=function(){return window.device=s,this},a.ios()?a.ipad()?g("ios ipad tablet"):a.iphone()?g("ios iphone mobile"):a.ipod()&&g("ios ipod mobile"):a.macos()?g("macos desktop"):a.android()?a.androidTablet()?g("android tablet"):g("android mobile"):a.blackberry()?a.blackberryTablet()?g("blackberry tablet"):g("blackberry mobile"):a.windows()?a.windowsTablet()?g("windows tablet"):a.windowsPhone()?g("windows mobile"):g("windows desktop"):a.fxos()?a.fxosTablet()?g("fxos tablet"):g("fxos mobile"):a.meego()?g("meego mobile"):a.nodeWebkit()?g("node-webkit"):a.television()?g("television"):a.desktop()&&g("desktop"),a.cordova()&&g("cordova"),a.onChangeOrientation=function(t){"function"==typeof t&&c.push(t)};var w="resize";function b(t){for(var e=0;e<t.length;e++)if(a[t[e]]())return t[e];return"unknown"}function C(){a.orientation=b(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(w="orientationchange"),window.addEventListener?window.addEventListener(w,y,!1):window.attachEvent?window.attachEvent(w,y):window[w]=y,y(),a.type=b(["mobile","tablet","desktop"]),a.os=b(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),C();const j=a;let O=class{getDeviceType(){return j.tablet()?"tablet":j.mobile()?"smartphone":"desktop"}};O=(0,i.Cg)([(0,o.Gr)()],O)},695:(t,e,n)=>{"use strict";n.d(e,{u:()=>l});var i,o,r,s=n(635),a=n(223),c=n(144),u=n(393),d=n(569);let l=class{constructor(t,e,n){this.cookiesManager=t,this.window=e,this.logger=n}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(t){this.geoData=t}getGeoData(){const t=this.getGeoDataFromCookie();return Object.keys(t).length?t:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const t=this.cookiesManager.get("Geo");if(!t)return{};const e=decodeURIComponent(t);try{return JSON.parse(e)}catch(t){return this.logger.error("Invalid JSON in the cookie",t),{}}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.country)||void 0===e?void 0:e.toLowerCase()}getRegionCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.region)||void 0===e?void 0:e.toLowerCase()}getContinentCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.continent)||void 0===e?void 0:e.toLowerCase()}isGdprCountry(){return d.e.includes(this.getCountryCode())}};l=(0,s.Cg)([(0,a.Gr)(),(0,s.Qj)(0,(0,a.WQ)(u.AZ)),(0,s.Qj)(1,(0,a.WQ)(u.jf)),(0,s.Qj)(2,(0,a.MR)(c.V,c.O,"Geo")),(0,s.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof CookiesManager&&CookiesManager)?i:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object,"function"==typeof(r=void 0!==c.V&&c.V)?r:Object])],l)},858:(t,e,n)=>{"use strict";n.d(e,{Q:()=>r});var i=n(635),o=n(223);let r=class{get(t){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield fetch(t,{method:"GET",mode:"cors"});if(!e.ok||200!==e.status)throw new Error(`HTTP error ${t}! Status: ${e.status}`);return e}))}};r=(0,i.Cg)([(0,o._G)()],r)},144:(t,e,n)=>{"use strict";n.d(e,{O:()=>c,V:()=>u});var i,o=n(635),r=n(38),s=n(223),a=n(393);class c{transform(t,e){return t.setLoggerGroup(e)}}let u=class{constructor(t){var e,n;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(n=null===(e=null==t?void 0:t.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==n?n:Date.now()}setLoggerGroup(t){return this.logGroup=t,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.C.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...t){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}warn(...t){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}error(...t){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}loggingEnabled(){return""!==this.debugGroup&&("1"===this.debugGroup||-1!==this.groups.indexOf(this.logGroup))}};u=(0,o.Cg)([(0,s._G)(),(0,o.Qj)(0,(0,s.WQ)(a.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],u)},439:(t,e,n)=>{"use strict";n.d(e,{O:()=>c,l:()=>o});var i,o,r=n(635),s=n(223),a=n(610);!function(t){t.F2="f2",t.BINGEBOT="bingebot",t.FUTHEAD="futhead",t.MUTHEAD="muthead",t.GAMESPOT="gamespot",t.COMICVINE="comicvine",t.GAMEFAQS="gamefaqs",t.METACRITIC="metacritic",t.METACRITIC_NEUTRON="metacritic-neutron",t.TVGUIDE="tvguide",t.TVGUIDE_MTC="tvguide-mtc",t.GIANTBOMB="giantbomb",t.FANATICAL="fanatical",t.FANDOMDESKTOP="fandomdesktop"}(o||(o={}));let c=class{constructor(t){this.adsContext=t}get(){var t;const e=this.adsContext.get();return(null!==(t=null==e?void 0:e.platform)&&void 0!==t?t:null==e?void 0:e.app)||this.detectPlatform()}detectPlatform(){var t,e,n;return void 0!==window.mw&&void 0!==(null===(n=null===(e=null===(t=window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.platformName)?window.ads.context.opts.platformName:this.checkHostname()}checkHostname(){const{hostname:t,pathname:e}=window.location;switch(!0){case t.includes("fandom"):return t.includes("bingebot")?o.BINGEBOT:o.F2;case t.includes("futhead"):return o.FUTHEAD;case t.includes("muthead"):return o.MUTHEAD;case t.includes("gamespot"):return t.includes("comicvine")?o.COMICVINE:t.includes("gamefaqs")?o.GAMEFAQS:o.GAMESPOT;case t.includes("metacritic"):return e.includes("news")?o.METACRITIC_NEUTRON:o.METACRITIC;case t.includes("tvguide"):return o.TVGUIDE;case t.includes("giantbomb"):return o.GIANTBOMB;case t.includes("fanatical"):return o.FANATICAL;default:return o.FANDOMDESKTOP}}};c=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.i)),(0,r.Sn)("design:paramtypes",["function"==typeof(i=void 0!==a.i&&a.i)?i:Object])],c)},38:(t,e,n)=>{"use strict";n.d(e,{C:()=>i});class i{static getURLSearchParams(){const t=window.location.search.substring(1);return new URLSearchParams(t)}static get(t){return i.getURLSearchParams().get(t)}static stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}}},874:(t,e,n)=>{"use strict";n.d(e,{O:()=>r});var i=n(635),o=n(223);let r=class{static extract(t){const e=t.split(".");if(e.length<2)return t;let n=`.${e[e.length-2]}.${e[e.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(n)>=0&&(n=`.${e[e.length-3]}${n}`),n}};r=(0,i.Cg)([(0,o._G)()],r)},799:(t,e,n)=>{"use strict";function i(t,e=10,n=50){return new Promise(((i,o)=>{let r=0;const s=setInterval((()=>{t()&&(clearInterval(s),i()),r++>e&&(clearInterval(s),o())}),n)}))}n.d(e,{f:()=>i})},167:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var i,o=n(635),r=n(223),s=n(393);let a=class{constructor(t){this.window=t}get(t,e=null){var n,i,o;return null!==(o=null===(i=null===(n=this.window.mw)||void 0===n?void 0:n.config)||void 0===i?void 0:i.get(t))&&void 0!==o?o:e}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],a)},223:(t,e,n)=>{"use strict";var i;n.d(e,{kL:()=>Q,cb:()=>p,WQ:()=>I,MR:()=>A,_G:()=>R,Gr:()=>_}),function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"}(i||(i={}));const o=i;var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function s(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function d(t){return!!t.useClass}function l(t){return!!t.useFactory}var h=function(){function t(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(t){var e,n=this,i=!1;return new Proxy({},this.createHandler((function(){return i||(e=t(n.wrap()),i=!0),e})))},t.prototype.createHandler=function(t){var e={};return this.reflectMethods.forEach((function(n){e[n]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e[0]=t(),Reflect[n].apply(void 0,u(e))}})),e},t}();function p(t){if(void 0===t)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new h(t)}function f(t){return"string"==typeof t||"symbol"==typeof t}function g(t){return"object"==typeof t&&"token"in t&&"transform"in t}function v(t){return!!t.useToken}function y(t){return null!=t.useValue}const m=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.setAll=function(t,e){this._registryMap.set(t,e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),b=function(){this.scopedResolutions=new Map};var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m);const O=function(){this.preResolution=new C,this.postResolution=new j};var S=new Map,k=function(){function t(t){this.parent=t,this._registry=new w,this.interceptors=new O,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(t,e,n){var i;if(void 0===n&&(n={lifecycle:o.Transient}),this.ensureNotDisposed(),i=function(t){return d(t)||y(t)||v(t)||l(t)}(e)?e:{useClass:e},v(i))for(var r=[t],s=i;null!=s;){var a=s.useToken;if(r.includes(a))throw new Error("Token registration cycle detected! "+u(r,[a]).join(" -> "));r.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((n.lifecycle===o.Singleton||n.lifecycle==o.ContainerScoped||n.lifecycle==o.ResolutionScoped)&&(y(i)||l(i)))throw new Error('Cannot use lifecycle "'+o[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},t.prototype.registerType=function(t,e){return this.ensureNotDisposed(),f(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),f(t)){if(f(e))return this.register(t,{useToken:e},{lifecycle:o.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:o.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!f(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:o.Singleton})},t.prototype.resolve=function(t,e){void 0===e&&(e=new b),this.ensureNotDisposed();var n=this.getRegistration(t);if(!n&&f(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),n){var i=this.resolveRegistration(n,e);return this.executePostResolutionInterceptor(t,i,"Single"),i}if(function(t){return"function"==typeof t||t instanceof h}(t))return i=this.construct(t,e),this.executePostResolutionInterceptor(t,i,"Single"),i;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var r=a(this.interceptors.preResolution.getAll(t)),s=r.next();!s.done;s=r.next()){var c=s.value;"Once"!=c.options.frequency&&o.push(c),c.callback(t,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,o)}},t.prototype.executePostResolutionInterceptor=function(t,e,n){var i,o;if(this.interceptors.postResolution.has(t)){var r=[];try{for(var s=a(this.interceptors.postResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var u=c.value;"Once"!=u.options.frequency&&r.push(u),u.callback(t,e,n)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,r)}},t.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n,i=t.options.lifecycle===o.Singleton,r=t.options.lifecycle===o.ContainerScoped,s=i||r;return n=y(t.provider)?t.provider.useValue:v(t.provider)?s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):d(t.provider)?s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):l(t.provider)?t.provider.useFactory(this):this.construct(t.provider,e),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.set(t,n),n},t.prototype.resolveAll=function(t,e){var n=this;void 0===e&&(e=new b),this.ensureNotDisposed();var i=this.getAllRegistrations(t);if(!i&&f(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),i){var o=i.map((function(t){return n.resolveRegistration(t,e)}));return this.executePostResolutionInterceptor(t,o,"All"),o}var r=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,r,"All"),r},t.prototype.isRegistered=function(t,e){return void 0===e&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=a(this._registry.entries()),i=n.next();!i.done;i=n.next()){var o=c(i.value,2),r=o[0],s=o[1];this._registry.setAll(r,s.filter((function(t){return!y(t.provider)})).map((function(t){return t.instance=void 0,t})))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.createChildContainer=function(){var e,n;this.ensureNotDisposed();var i=new t(this);try{for(var r=a(this._registry.entries()),s=r.next();!s.done;s=r.next()){var u=c(s.value,2),d=u[0],l=u[1];l.some((function(t){return t.options.lifecycle===o.ContainerScoped}))&&i._registry.setAll(d,l.map((function(t){return t.options.lifecycle===o.ContainerScoped?{provider:t.provider,options:t.options}:t})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i},t.prototype.beforeResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},t.prototype.afterResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},t.prototype.dispose=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach((function(e){var n=e.dispose();n&&t.push(n)})),[4,Promise.all(t)];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t,e){var n=this;if(t instanceof h)return t.createProxy((function(t){return n.resolve(t,e)}));var i,o=function(){var i=S.get(t);if(!i||0===i.length){if(0===t.length)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var o=i.map(n.resolveParams(e,t));return new(t.bind.apply(t,u([void 0],o)))}();return"function"!=typeof(i=o).dispose||i.dispose.length>0||this.disposables.add(o),o},t.prototype.resolveParams=function(t,e){var n=this;return function(i,o){var r,s,a,d;try{return"object"==typeof(d=i)&&"token"in d&&"multiple"in d?g(i)?i.multiple?(r=n.resolve(i.transform)).transform.apply(r,u([n.resolveAll(i.token)],i.transformArgs)):(s=n.resolve(i.transform)).transform.apply(s,u([n.resolve(i.token,t)],i.transformArgs)):i.multiple?n.resolveAll(i.token):n.resolve(i.token,t):g(i)?(a=n.resolve(i.transform,t)).transform.apply(a,u([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(t){throw new Error(function(t,e,n){var i,o,r,s,a=c(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return i="Cannot inject the dependency "+(s=e,(null===(r=void 0===a?null:a)?"at position #"+s:'"'+r.split(",")[s].trim()+'" at position #'+s)+' of "')+t.name+'" constructor. Reason:',void 0===o&&(o="    "),u([i],n.message.split("\n").map((function(t){return o+t}))).join("\n")}(e,o,t))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),Q=new k,T="injectionTokens";function E(t,e){return function(n,i,o){var r=Reflect.getOwnMetadata(T,n)||{};r[o]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(T,r,n)}}const I=function(t){return E(t)},R=function(){return function(t){S.set(t,function(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],n=Reflect.getOwnMetadata(T,t)||{};return Object.keys(n).forEach((function(t){e[+t]=n[t]})),e}(t))}},_=function(){return function(t){R()(t),Q.registerSingleton(t)}},A=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return E(t,{transformToken:e,args:n})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},698:(t,e,n)=>{var i;!function(t){!function(e){var i="object"==typeof globalThis?globalThis:"object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:function(){throw new ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),o=r(t);function r(t,e){return function(n,i){Object.defineProperty(t,n,{configurable:!0,writable:!0,value:i}),e&&e(n,i)}}void 0!==i.Reflect&&(o=r(i.Reflect,o)),function(t,e){var n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:M("Symbol.toPrimitive not found."),o=n&&void 0!==Symbol.iterator?Symbol.iterator:M("Symbol.iterator not found."),r=Object.getPrototypeOf(Function),s="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:M("A valid Map constructor could not be found."),a="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:M("A valid Set constructor could not be found."),c="function"==typeof WeakMap?WeakMap:M("A valid WeakMap constructor could not be found."),u=n?Symbol.for("@reflect-metadata:registry"):void 0,d=function(){var t;return!b(u)&&j(e.Reflect)&&Object.isExtensible(e.Reflect)&&(t=e.Reflect[u]),b(t)&&(t=function(){var t,n,i,o;b(u)||void 0===e.Reflect||u in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(t=function(t){var e=t.defineMetadata,n=t.hasOwnMetadata,i=t.getOwnMetadata,o=t.getOwnMetadataKeys,r=t.deleteMetadata,s=new c;return{isProviderFor:function(t,e){var n=s.get(t);return b(n)?!!o(t,e).length&&(b(n)&&(n=new a,s.set(t,n)),n.add(e),!0):n.has(e)},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:i,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:r}}(e.Reflect));var r=new c,d={registerProvider:l,getProvider:p,setProvider:g};return d;function l(e){if(!Object.isExtensible(d))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===e:break;case b(n):n=e;break;case n===e:break;case b(i):i=e;break;case i===e:break;default:void 0===o&&(o=new a),o.add(e)}}function h(e,r){if(!b(n)){if(n.isProviderFor(e,r))return n;if(!b(i)){if(i.isProviderFor(e,r))return n;if(!b(o))for(var s=R(o);;){var a=A(s);if(!a)return;var c=_(a);if(c.isProviderFor(e,r))return P(s),c}}}if(!b(t)&&t.isProviderFor(e,r))return t}function p(t,e){var n,i=r.get(t);return b(i)||(n=i.get(e)),b(n)?(b(n=h(t,e))||(b(i)&&(i=new s,r.set(t,i)),i.set(e,n)),n):n}function f(t){if(b(t))throw new TypeError;return n===t||i===t||!b(o)&&o.has(t)}function g(t,e,n){if(!f(n))throw new Error("Metadata provider not registered.");var i=p(t,e);if(i!==n){if(!b(i))return!1;var o=r.get(t);b(o)&&(o=new s,r.set(t,o)),o.set(e,n)}return!0}}()),!b(u)&&j(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,u,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}(),l=function(t){var e=new c,n={isProviderFor:function(t,n){var i=e.get(t);return!b(i)&&i.has(n)},OrdinaryDefineOwnMetadata:function(t,e,n,o){i(n,o,!0).set(t,e)},OrdinaryHasOwnMetadata:function(t,e,n){var o=i(e,n,!1);return!b(o)&&S(o.has(t))},OrdinaryGetOwnMetadata:function(t,e,n){var o=i(e,n,!1);if(!b(o))return o.get(t)},OrdinaryOwnMetadataKeys:function(t,e){var n=[],o=i(t,e,!1);if(b(o))return n;for(var r=R(o.keys()),s=0;;){var a=A(r);if(!a)return n.length=s,n;var c=_(a);try{n[s]=c}catch(t){try{P(r)}finally{throw t}}s++}},OrdinaryDeleteMetadata:function(t,n,o){var r=i(n,o,!1);if(b(r))return!1;if(!r.delete(t))return!1;if(0===r.size){var s=e.get(n);b(s)||(s.delete(o),0===s.size&&e.delete(s))}return!0}};return d.registerProvider(n),n;function i(i,o,r){var a=e.get(i),c=!1;if(b(a)){if(!r)return;a=new s,e.set(i,a),c=!0}var u=a.get(o);if(b(u)){if(!r)return;if(u=new s,a.set(o,u),!t.setProvider(i,o,n))throw a.delete(o),c&&e.delete(i),new Error("Wrong provider for target.")}return u}}(d);function h(t,e,n){if(p(t,e,n))return!0;var i=W(e);return!C(i)&&h(t,i,n)}function p(t,e,n){var i=D(e,n,!1);return!b(i)&&S(i.OrdinaryHasOwnMetadata(t,e,n))}function f(t,e,n){if(p(t,e,n))return g(t,e,n);var i=W(e);return C(i)?void 0:f(t,i,n)}function g(t,e,n){var i=D(e,n,!1);if(!b(i))return i.OrdinaryGetOwnMetadata(t,e,n)}function v(t,e,n,i){D(n,i,!0).OrdinaryDefineOwnMetadata(t,e,n,i)}function y(t,e){var n=m(t,e),i=W(t);if(null===i)return n;var o=y(i,e);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new a,s=[],c=0,u=n;c<u.length;c++){var d=u[c];r.has(d)||(r.add(d),s.push(d))}for(var l=0,h=o;l<h.length;l++)d=h[l],r.has(d)||(r.add(d),s.push(d));return s}function m(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function w(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function b(t){return void 0===t}function C(t){return null===t}function j(t){return"object"==typeof t?null!==t:"function"==typeof t}function O(t,e){switch(w(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",o=I(t,i);if(void 0!==o){var r=o.call(t,n);if(j(r))throw new TypeError;return r}return function(t,e){if("string"===e){var n=t.toString;if(T(n)&&!j(o=n.call(t)))return o;if(T(i=t.valueOf)&&!j(o=i.call(t)))return o}else{var i;if(T(i=t.valueOf)&&!j(o=i.call(t)))return o;var o,r=t.toString;if(T(r)&&!j(o=r.call(t)))return o}throw new TypeError}(t,"default"===n?"number":n)}function S(t){return!!t}function k(t){var e=O(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function Q(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function T(t){return"function"==typeof t}function E(t){return"function"==typeof t}function I(t,e){var n=t[e];if(null!=n){if(!T(n))throw new TypeError;return n}}function R(t){var e=I(t,o);if(!T(e))throw new TypeError;var n=e.call(t);if(!j(n))throw new TypeError;return n}function _(t){return t.value}function A(t){var e=t.next();return!e.done&&e}function P(t){var e=t.return;e&&e.call(t)}function W(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r)return e;if(e!==r)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var o=i.constructor;return"function"!=typeof o||o===t?e:o}function M(t){throw t}function D(t,e,n){var i=d.getProvider(t,e);if(!b(i))return i;if(n){if(d.setProvider(t,e,l))return l;throw new Error("Illegal state.")}}t("decorate",(function(t,e,n,i){if(b(n)){if(!Q(t))throw new TypeError;if(!E(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var i=(0,t[n])(e);if(!b(i)&&!C(i)){if(!E(i))throw new TypeError;e=i}}return e}(t,e)}if(!Q(t))throw new TypeError;if(!j(e))throw new TypeError;if(!j(i)&&!b(i)&&!C(i))throw new TypeError;return C(i)&&(i=void 0),function(t,e,n,i){for(var o=t.length-1;o>=0;--o){var r=(0,t[o])(e,n,i);if(!b(r)&&!C(r)){if(!j(r))throw new TypeError;i=r}}return i}(t,e,n=k(n),i)})),t("metadata",(function(t,e){return function(n,i){if(!j(n))throw new TypeError;if(!b(i)&&!function(t){switch(w(t)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;v(t,e,n,i)}})),t("defineMetadata",(function(t,e,n,i){if(!j(n))throw new TypeError;return b(i)||(i=k(i)),v(t,e,n,i)})),t("hasMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),h(t,e,n)})),t("hasOwnMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),p(t,e,n)})),t("getMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),f(t,e,n)})),t("getOwnMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),g(t,e,n)})),t("getMetadataKeys",(function(t,e){if(!j(t))throw new TypeError;return b(e)||(e=k(e)),y(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!j(t))throw new TypeError;return b(e)||(e=k(e)),m(t,e)})),t("deleteMetadata",(function(t,e,n){if(!j(e))throw new TypeError;b(n)||(n=k(n));var i=D(e,n,!1);return!b(i)&&i.OrdinaryDeleteMetadata(t,e,n)}))}(o,i),void 0===i.Reflect&&(i.Reflect=t)}()}(i||(i={}))},635:(t,e,n)=>{"use strict";function i(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function o(t,e){return function(n,i){e(n,i,t)}}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}n.d(e,{Cg:()=>i,Qj:()=>o,Sn:()=>r,sH:()=>s}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return n[t](r,r.exports,o),r.exports}o.m=n,o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,n)=>(o.f[n](t,e),e)),[])),o.u=t=>({224:"fandom-gdpr-consents",319:"static-consents",482:"fanatical-consents",832:"one-trust-consents"}[t]+".js"),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="identity-engine:",o.l=(n,i,r,s)=>{if(t[n])t[n].push(i);else{var a,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var l=u[d];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+r){a=l;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+r),a.src=n),t[n]=[i];var h=(e,i)=>{a.onerror=a.onload=null,clearTimeout(p);var o=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((t=>t(i))),e)return e(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={57:0};o.f.j=(e,n)=>{var i=o.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,o)=>i=t[e]=[n,o]));n.push(i[2]=r);var s=o.p+o.u(e),a=new Error;o.l(s,(n=>{if(o.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[s,a,c]=n,u=0;if(s.some((e=>0!==t[e]))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);c&&c(o)}for(e&&e(n);u<s.length;u++)r=s[u],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),(()=>{"use strict";var t=o(635),e=(o(698),o(223));function n(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}var i=function t(e,i){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=n({},i,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in r)r[a]&&(s+="; "+a,!0!==r[a]&&(s+="="+r[a].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+s}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],i={},o=0;o<n.length;o++){var r=n[o].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(i[a]=e.read(s,a),t===a)break}catch(t){}}return t?i[t]:i}},remove:function(t,e){o(t,"",n({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,n({},this.attributes,e))},withConverter:function(e){return t(n({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const a=new Uint8Array(16);function c(){if(!s&&(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(a)}const u=[];for(let t=0;t<256;++t)u.push((t+256).toString(16).slice(1));var d,l=o(144),h=o(858),p=o(393),f=o(695),g=o(610);let v=class{constructor(t){this.adsContext=t}get(){var t;return"dev"===(null===(t=this.adsContext.get())||void 0===t?void 0:t.env)?"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/":"https://services.fandom.com/"}};var y,m,w,b,C;v=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(g.i)),(0,t.Sn)("design:paramtypes",["function"==typeof(d=void 0!==g.i&&g.i)?d:Object])],v);let j=class{constructor(t,e,n,i,o){this.cookiesManager=t,this.httpClient=e,this.logger=n,this.geo=i,this.serviceBaseUrl=o,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,t.sH)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))return void this.logger.info("Geo cookie already exists");const t=yield this.httpClient.get(this.geoIPUrl),{country_code:e,region:n,continent_code:i}=yield t.json(),o={country:e,region:n,continent:i},r=JSON.stringify(o);this.cookiesManager.set("Geo",r,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")}))}};j=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Qj)(1,(0,e.WQ)(h.Q)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"GeoCookie")),(0,t.Qj)(3,(0,e.WQ)(f.u)),(0,t.Qj)(4,(0,e.WQ)(v)),(0,t.Sn)("design:paramtypes",["function"==typeof(y="undefined"!=typeof CookiesManager&&CookiesManager)?y:Object,"function"==typeof(m=void 0!==h.Q&&h.Q)?m:Object,"function"==typeof(w=void 0!==l.V&&l.V)?w:Object,"function"==typeof(b=void 0!==f.u&&f.u)?b:Object,"function"==typeof(C=void 0!==v&&v)?C:Object])],j);var O,S,k,Q,T,E,I,R=o(155),_=o(349),A=o(874),P=o(167),W=o(517);let M=class{constructor(t,e,n,i,o,r,s){this.cookiesManager=t,this.window=e,this.wikiConfig=n,this.context=i,this.logger=o,this.geo=r,this.uspApi=s,this.ageGateCookie="ag",this.ageGateLegacyCookie="age_gate",this.ageGateExpiryMs=31536e6}init(e){var n,i;return(0,t.sH)(this,void 0,void 0,(function*(){if(!Boolean(null===(i=null===(n=this.context.get())||void 0===n?void 0:n.targeting)||void 0===i?void 0:i.directedAtChildren)||!this.wikiConfig.get("wgAgeGateEnabled",!1))return this.logger.info("disabled"),Promise.resolve();const t=this.cookiesManager.get(this.ageGateLegacyCookie);return t?(this.updateLegacyCookie(t),Promise.resolve()):(this.cookiesManager.get(this.ageGateCookie)||(yield this.waitForAgeGateDataAndSetCookie(e)),Promise.resolve())}))}waitForAgeGateDataAndSetCookie(e){return(0,t.sH)(this,void 0,void 0,(function*(){return new Promise((t=>{e.on(_.c.AGE_GATE_DATA,(({payload:e})=>{this.setAgeGateCookie(e),"us"!==this.geo.getCountryCode()||e.adult||this.setUsPrivacyCookie(W.u.yes),t()}))}))}))}setAgeGateCookie(t){var e,n;t||this.logger.warn("Payload data missing, using defaults");const i=null!==(e=null==t?void 0:t.adult)&&void 0!==e&&e,o=null!==(n=null==t?void 0:t.timestamp)&&void 0!==n?n:Date.now();this.cookiesManager.set(this.ageGateCookie,i?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(o+this.ageGateExpiryMs)})}setUsPrivacyCookie(t){this.uspApi.createPrivacyCookie(t)}updateLegacyCookie(t){if(t.length>=3){const e=t.split("|");this.setAgeGateCookie({adult:"1"===e[1],timestamp:Date.now()})}this.cookiesManager.remove(this.ageGateLegacyCookie,{domain:this.getTopLevelDomain()})}getTopLevelDomain(){const t=this.window.location.hostname;return A.O.extract(t)}};M=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Qj)(1,(0,e.WQ)(p.jf)),(0,t.Qj)(2,(0,e.WQ)(P.j)),(0,t.Qj)(3,(0,e.WQ)(g.i)),(0,t.Qj)(4,(0,e.MR)(l.V,l.O,"AgeGate")),(0,t.Qj)(5,(0,e.WQ)(f.u)),(0,t.Qj)(6,(0,e.WQ)(W.h)),(0,t.Sn)("design:paramtypes",["function"==typeof(O="undefined"!=typeof CookiesManager&&CookiesManager)?O:Object,"function"==typeof(S="undefined"!=typeof Window&&Window)?S:Object,"function"==typeof(k=void 0!==P.j&&P.j)?k:Object,"function"==typeof(Q=void 0!==g.i&&g.i)?Q:Object,"function"==typeof(T=void 0!==l.V&&l.V)?T:Object,"function"==typeof(E=void 0!==f.u&&f.u)?E:Object,"function"==typeof(I=void 0!==W.h&&W.h)?I:Object])],M);var D,x,G,L=o(85),N=o(712),V=o(489),U=o(841);let H=class{constructor(t,e,n){this.dataWarehouse=t,this.window=e,this.logger=n}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const t=this.extractHEMs();Object.keys(t).forEach((e=>{t[e]&&this.dataWarehouse.track(V.i.identity,{partner_name:"MediaWiki-"+e,partner_identity_id:t[e]})}))}isEnabled(){var t,e,n;return(null===(n=null===(e=null===(t=this.window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[t,e,n]=this.window.ads.context.opts.userEmailHashes;return{md5:t,sha1:e,sha256:n}}};var F,$;H=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(U.X)),(0,t.Qj)(1,(0,e.WQ)(p.jf)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"HemTracking")),(0,t.Sn)("design:paramtypes",["function"==typeof(D=void 0!==U.X&&U.X)?D:Object,"function"==typeof(x="undefined"!=typeof Window&&Window)?x:Object,"function"==typeof(G=void 0!==l.V&&l.V)?G:Object])],H),function(t){t.tracking="tracking",t.page="page",t.site="site",t.partners="partners",t.targeting="targeting"}($||($={}));let B=class{constructor(t){this.window=t}get(t,e){return this.window.fandomContext[t][e]}set(t,e,n){this.window.fandomContext&&this.window.fandomContext[t]||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{[t]:{}})),this.window.fandomContext[t][e]=n.value}remove(t,e){try{delete this.window.fandomContext[t][e]}catch(t){}}};var q;B=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(F="undefined"!=typeof Window&&Window)?F:Object])],B);let z=class{constructor(t){this.cookiesManager=t}get(t){return this.cookiesManager.get(t)}set(t,e){const{value:n,domain:i,expiresMS:o}=e,r=new Date((new Date).getTime()+o);this.cookiesManager.set(t,n.toString(),{domain:i,expires:r})}remove(t){this.cookiesManager.remove(t)}};z=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(q="undefined"!=typeof CookiesManager&&CookiesManager)?q:Object])],z);let Y=class{generate(){let t="";for(;t.length<10;)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return t}};var K;Y=(0,t.Cg)([(0,e._G)()],Y);let J=class{constructor(t){this.cookiesManager=t}getNextNumberFromCookie(t){const e=parseInt(this.cookiesManager.get(t));return Number.isNaN(e)?1:e+1}};var X,Z,tt,et,nt,it,ot;J=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(K="undefined"!=typeof CookiesManager&&CookiesManager)?K:Object])],J);const rt=18e5;let st=class{constructor(t,e,n,i,o,r,s,a){this.contextRepository=t,this.cookieRepository=e,this.uuid=n,this.beaconGenerator=i,this.pageViewNumberGenerator=o,this.window=r,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(_.c.PAGE_CHANGED,(()=>{this.updatePageViewData()}))}set(t,e){this.contextRepository.set($.tracking,t,e),this.cookieRepository.set(t,e)}remove(t){this.contextRepository.remove($.tracking,t),this.cookieRepository.remove(t)}updatePageViewData(){const t=this.window.location.hostname,e=A.O.extract(t);this.contextRepository.set($.tracking,"pvUID",{domain:t,expiresMS:rt,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:t,expiresMS:rt,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:e,expiresMS:rt,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const t=this.window.location.hostname,e=A.O.extract(t),n={domain:e,expiresMS:15552e6,value:this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId")||this.beaconGenerator.generate()};this.contextRepository.set($.tracking,"beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const i=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),o={domain:e,expiresMS:rt,value:i||this.uuid()};this.set("sessionId",o)}setup(){this.updateUserTrackingData(),this.updatePageViewData()}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};st=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(B)),(0,t.Qj)(1,(0,e.WQ)(z)),(0,t.Qj)(2,(0,e.WQ)(p.kk)),(0,t.Qj)(3,(0,e.WQ)(Y)),(0,t.Qj)(4,(0,e.WQ)(J)),(0,t.Qj)(5,(0,e.WQ)(p.jf)),(0,t.Qj)(6,(0,e.WQ)(P.j)),(0,t.Qj)(7,(0,e.WQ)(L.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(X=void 0!==B&&B)?X:Object,"function"==typeof(Z=void 0!==z&&z)?Z:Object,Function,"function"==typeof(tt=void 0!==Y&&Y)?tt:Object,"function"==typeof(et=void 0!==J&&J)?et:Object,"function"==typeof(nt="undefined"!=typeof Window&&Window)?nt:Object,"function"==typeof(it=void 0!==P.j&&P.j)?it:Object,"function"==typeof(ot=void 0!==L.U&&L.U)?ot:Object])],st);var at,ct=o(799);class ut{constructor(t){this.options=t,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((t=>t.src===ut.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==ut.ALLOWED_URLS.find((t=>window.location.hostname.includes(t)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.hub}setTags(t){this.tags=t}captureException(t){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,t),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(t),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(t),void(0,ct.f)((()=>this.loaded),10,100).then((()=>{this.createSentryInstance(),this.flushErrorQueue()}));this.initialized||this.createSentryInstance(),this.hub.captureException(t)}}loadSentry(){return new Promise((t=>{const e=document.createElement("script");e.defer=!0,e.src=ut.SENTRY_SCRIPT_CDN_URL,e.crossOrigin="anonymous",e.integrity=ut.SENTRY_SCRIPT_INTEGRITY,e.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),t()},document.getElementsByTagName("script")[0].parentNode.append(e)}))}createSentryInstance(){const{Breadcrumbs:t,BrowserClient:e,Dedupe:n,defaultStackParser:i,HttpContext:o,Hub:r,LinkedErrors:s,makeFetchTransport:a}=window.Sentry,c=new e(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:a,stackParser:i,integrations:[new t,new n,new o,new s]}));this.hub=new r(c),this.hub.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((t=>{var e;return null===(e=this.hub)||void 0===e?void 0:e.captureException(t)}))}}ut.ALLOWED_URLS=["fandom.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],ut.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.55.2/bundle.min.js",ut.SENTRY_SCRIPT_INTEGRITY="sha384-grzsqzUax9BbmJWNgYTLmejARf1orUEVEvvg2sXJ60jMyjmzW/Eh8hrCFkSu6GNm";let dt=class{constructor(t){this.sentry=t}resolve(t,e,n){var i;t.geoRequiresConsent&&t.gdprConsent||t.geoRequiresSignal&&!t.ccpaSignal||!t.geoRequiresSignal&&!t.geoRequiresConsent?(this.consentGiven=!0,null===(i=e())||void 0===i||i.catch((t=>this.sentry.captureException(t)))):(t.geoRequiresSignal&&t.ccpaSignal||t.geoRequiresConsent&&!t.gdprConsent)&&(this.consentGiven=!1,n())}getConsents(){return this.consentGiven}};dt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.eF)),(0,t.Sn)("design:paramtypes",["function"==typeof(at=void 0!==ut&&ut)?at:Object])],dt);var lt=o(28),ht=o(38),pt=o(538),ft=o(546),gt=o(439);class vt{constructor(t,n,i){this.window=t,this.cookiesManager=n,this.communicationService=i,this.cacheStorage={},this.cacheKey="basset";const o=e.kL.resolve(l.V);o.setLoggerGroup("InstantConfig"),this.logger=o,this.resetCache()}resetCache(){const t=this.cookiesManager.get(this.cacheKey)||"";var e;this.cacheStorage=""===(e=t)||"string"!=typeof e?{}:e.split("|").reduce(((t,e)=>Object.assign(Object.assign({},t),function(t){const[e,n]=t.split(":"),i="true"===n,[o,r,s]=e.split("_");return{[o]:{name:o,group:r,limit:parseFloat(s)||void 0,result:i,withCookie:!0}}}(e))),{}),this.logger.info("reset cache",this.cacheStorage)}get(t){return this.cacheStorage[t]}set(t){this.cacheStorage[t.name]=t}remove(t){delete this.cacheStorage[t]}synchronizeCookie(){this.communicationService.on(_.c.CONSENT_READY,(({gdprConsent:t})=>{t&&(this.saveCookie(),this.communicationService.emit(new R.r(_.c.INSTANT_CONFIG_CACHE_READY)))}))}saveCookie(){const t=Object.keys(this.cacheStorage).map((t=>({key:t,value:this.cacheStorage[t]}))).filter((({value:t})=>t.withCookie)).reduce(((t,{key:e,value:n})=>Object.assign(Object.assign({},t),{[e]:n})),{}),e=this.window.location.hostname,n=A.O.extract(e),i=(o=t,Object.keys(o).slice(0,5).map(function(t){return e=>{const{name:n,group:i,limit:o,result:r}=t[e];return`${n}_${i}_${o}:${r}`}}(o)).join("|"));var o;this.cookiesManager.set(this.cacheKey,i,{domain:n,expires:180}),this.logger.info("saved in cookie",this.cacheStorage,i)}}var yt,mt,wt,bt,Ct,jt,Ot,St,kt;let Qt=class{constructor(t,e,n,i,o,r,s,a,c){this.adsContext=t,this.device=e,this.browser=n,this.platform=i,this.geo=o,this.serviceBaseUrl=r,this.window=s,this.cookiesManager=a,this.logger=c}init(e,n={}){var i;return(0,t.sH)(this,void 0,void 0,(function*(){const t=null===(i=this.adsContext.get())||void 0===i?void 0:i.env,o=this.serviceBaseUrl.get().slice(0,-1),r=this.platform.get(),s=this.geo.get(),a=`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=t?t:"prod"}/icbm_state_${r}.json`,c=new lt.InstantConfigLoader({appName:r,instantConfigEndpoint:o,instantConfigFallbackEndpoint:a}),u=new vt(this.window,this.cookiesManager,e),d=new lt.InstantConfigInterpreter(new lt.BrowserMatcher(this.browser.getBrowser()),new lt.DeviceMatcher(this.device.getDeviceType()),new lt.DomainMatcher,new lt.RegionMatcher(s),u);let l=yield c.getConfig();l=(new lt.InstantConfigOverrider).override(ht.C.getURLSearchParams(),l);const h=d.init(l,n);return this.repository=h.getValues(),u.synchronizeCookie(),this.logger.info("instantiated with",this.repository),this}))}get(t,e){return t in this.repository&&void 0!==this.repository[t]?this.repository[t]:e}};var Tt,Et;Qt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(g.i)),(0,t.Qj)(1,(0,e.WQ)(pt.p)),(0,t.Qj)(2,(0,e.WQ)(ft.P)),(0,t.Qj)(3,(0,e.WQ)(gt.O)),(0,t.Qj)(4,(0,e.WQ)(f.u)),(0,t.Qj)(5,(0,e.WQ)(v)),(0,t.Qj)(6,(0,e.WQ)(p.jf)),(0,t.Qj)(7,(0,e.WQ)(p.AZ)),(0,t.Qj)(8,(0,e.MR)(l.V,l.O,"InstantConfig")),(0,t.Sn)("design:paramtypes",["function"==typeof(yt=void 0!==g.i&&g.i)?yt:Object,"function"==typeof(mt=void 0!==pt.p&&pt.p)?mt:Object,"function"==typeof(wt=void 0!==ft.P&&ft.P)?wt:Object,"function"==typeof(bt=void 0!==gt.O&&gt.O)?bt:Object,"function"==typeof(Ct=void 0!==f.u&&f.u)?Ct:Object,"function"==typeof(jt=void 0!==v&&v)?jt:Object,"function"==typeof(Ot="undefined"!=typeof Window&&Window)?Ot:Object,"function"==typeof(St="undefined"!=typeof CookiesManager&&CookiesManager)?St:Object,"function"==typeof(kt=void 0!==l.V&&l.V)?kt:Object])],Qt),function(t){t.LOCAL="local",t.IDENTITY_STORAGE="identity_storage"}(Tt||(Tt={}));let It=class{constructor(t){this.window=t}getItem(t){let e=null;try{return e=this.window.localStorage.getItem(t),JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;try{this.window.localStorage.setItem(t,n)}catch(t){}}removeItem(t){return this.window.localStorage.removeItem(t)}};var Rt,_t,At;It=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(Et="undefined"!=typeof Window&&Window)?Et:Object])],It);let Pt=class{constructor(t,e,n,i){this.logger=t,this.uuid=e,this.storage=n,this.serviceBaseUrl=i,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.ISUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=new AbortController,e=setTimeout((()=>t.abort()),1e3);return fetch(this.ISUrl,{mode:"cors",credentials:"include",signal:t.signal}).then((t=>(clearTimeout(e),200===t.status||202===t.status?t.json():this.createFallbackResponse()))).catch((t=>(this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",t),this.createFallbackResponse())))}))}postData(e){return(0,t.sH)(this,void 0,void 0,(function*(){return fetch(this.ISUrl+"identity",{credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify({ppid:e.ppid})}).then((t=>t.json()))}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(t){this.storage.setItem(this.IdentityStorageKey,t)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};var Wt,Mt,Dt,xt,Gt;Pt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(p.kk)),(0,t.Qj)(2,(0,e.WQ)(It)),(0,t.Qj)(3,(0,e.WQ)(v)),(0,t.Sn)("design:paramtypes",["function"==typeof(Rt=void 0!==l.V&&l.V)?Rt:Object,Function,"function"==typeof(_t=void 0!==It&&It)?_t:Object,"function"==typeof(At=void 0!==v&&v)?At:Object])],Pt);let Lt=class{constructor(t,e,n,i,o){this.storage=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageClient=o}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.getLocalData();return t&&!t.synced&&this.setRemote(t),!t||this.isDeprecated(t)?this.getRemote():(this.setIdentityContextVariables(t),t)}))}setRemote(e){return(0,t.sH)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(e);const t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(t){this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(t){const e=this.instantConfigService.get("icIdentityTtl",6048e5),n=Date.now()-e;return!t.timestamp||t.timestamp-n<0}getLocalData(){return(0,t.sH)(this,void 0,void 0,(function*(){let t=yield this.identityStorageClient.getLocalData();if(!t){const e=this.getLocalPPID()||this.getAdmsPPID();e&&(t=yield this.migrateDeprecatedIdentity(e))}return t}))}migrateDeprecatedIdentity(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t}))}getAdmsPPID(){var t,e;const n=this.storage.getItem("silver-surfer-active-data-v2");return null===(e=null===(t=null==n?void 0:n.IDENTITY)||void 0===t?void 0:t[0].payload)||void 0===e?void 0:e.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}))}setIdentityContextVariables(t){t.over18&&this.windowContextRepository.set($.tracking,"over_18",{value:"1"})}};var Nt,Vt;Lt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(It)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(B)),(0,t.Qj)(3,(0,e.WQ)(Qt)),(0,t.Qj)(4,(0,e.WQ)(Pt)),(0,t.Sn)("design:paramtypes",["function"==typeof(Wt=void 0!==It&&It)?Wt:Object,"function"==typeof(Mt=void 0!==l.V&&l.V)?Mt:Object,"function"==typeof(Dt=void 0!==B&&B)?Dt:Object,"function"==typeof(xt=void 0!==Qt&&Qt)?xt:Object,"function"==typeof(Gt=void 0!==Pt&&Pt)?Gt:Object])],Lt);let Ut=class{constructor(t,e){this.logger=t,this.identityStorageService=e}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageService.get();return this.logger.info(t),t.ppid}))}};var Ht,Ft;Ut=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(Lt)),(0,t.Sn)("design:paramtypes",["function"==typeof(Nt=void 0!==l.V&&l.V)?Nt:Object,"function"==typeof(Vt=void 0!==Lt&&Lt)?Vt:Object])],Ut);let $t=class{constructor(t,e,n){this.logger=t,this.uuid=e,this.storage=n}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const t=this.uuid();return this.storage.setItem("ppid",t),t}};var Bt,qt,zt,Yt,Kt,Jt,Xt;$t=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(p.kk)),(0,t.Qj)(2,(0,e.WQ)(It)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ht=void 0!==l.V&&l.V)?Ht:Object,Function,"function"==typeof(Ft=void 0!==It&&It)?Ft:Object])],$t);let Zt=class{constructor(t,e,n,i,o,r,s){this.dataWarehouse=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageRepository=o,this.localStorageRepository=r,this.communicationService=s}getPPID(t){switch(this.logger.info("active strategy: ",t),t){case Tt.IDENTITY_STORAGE:return this.identityStorageRepository;case Tt.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=this.instantConfigService.get("icPpidRepository",Tt.LOCAL),e=yield this.getPPID(t).get();this.dataWarehouse.track(V.i.identity,{partner_name:"Google",partner_identity_id:e}),this.communicationService.emit(new R.r(_.c.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:e}})),this.windowContextRepository.set($.tracking,"ppid",{value:e}),this.logger.info("Passed PPID to page-level targeting")}catch(t){this.logger.error("Setting up PPID has failed!",t)}}))}setPpid(){return(0,t.sH)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};var te,ee,ne,ie;Zt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(U.X)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(B)),(0,t.Qj)(3,(0,e.WQ)(Qt)),(0,t.Qj)(4,(0,e.WQ)(Ut)),(0,t.Qj)(5,(0,e.WQ)($t)),(0,t.Qj)(6,(0,e.WQ)(L.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(Bt=void 0!==U.X&&U.X)?Bt:Object,"function"==typeof(qt=void 0!==l.V&&l.V)?qt:Object,"function"==typeof(zt=void 0!==B&&B)?zt:Object,"function"==typeof(Yt=void 0!==Qt&&Qt)?Yt:Object,"function"==typeof(Kt=void 0!==Ut&&Ut)?Kt:Object,"function"==typeof(Jt=void 0!==$t&&$t)?Jt:Object,"function"==typeof(Xt=void 0!==L.U&&L.U)?Xt:Object])],Zt);let oe=class{constructor(t,e,n,i){this.window=t,this.logger=e,this.context=n,this.cookieRepository=i,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(t){this.coppaSubject=t,this.window.fandomContext.partners.directedAtChildren=t,this.window.fandomContext.partners.blockthrough={directedAtChildren:t}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var t,e;if(!Boolean(null===(e=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===e?void 0:e.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const t="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(t),t}catch(t){this.logger.error("Error while reading age gate cookie")}}};var re,se,ae,ce;oe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"CoppaSubject")),(0,t.Qj)(2,(0,e.WQ)(g.i)),(0,t.Qj)(3,(0,e.WQ)(z)),(0,t.Sn)("design:paramtypes",["function"==typeof(te="undefined"!=typeof Window&&Window)?te:Object,"function"==typeof(ee=void 0!==l.V&&l.V)?ee:Object,"function"==typeof(ne=void 0!==g.i&&g.i)?ne:Object,"function"==typeof(ie=void 0!==z&&z)?ie:Object])],oe);let ue=class{constructor(t,e,n,i){this.platform=e,this.window=n,this.logger=i,this.enabled=!1,this.endpoint=`${t.get()}adeng/api/identity/metrics`}init(t){var e;const n=t.get("icMonitorTrafficThreshold",{identity:0});var i;this.enabled="object"==typeof(i=n)&&!Array.isArray(i)&&null!==i&&(null==n?void 0:n.identity)>0&&n.identity>=100*Math.random(),this.logger.info(`Metric reporter enabled: ${this.enabled}, threshold:`,n),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(e=this.window)||void 0===e||e.addEventListener("load",(()=>this.sendPerformanceMetrics())))}send(t,e=0){if(!this.enabled)return;const n=new URL(this.endpoint);n.searchParams.set("app",this.platform.get()),n.searchParams.set("action",t);const i=e>0?e:this.logger.getTimeDelta();n.searchParams.set("duration",Math.round(i).toString()),fetch(n,{mode:"no-cors"})}sendPerformanceMetrics(){const t=this.window.performance.getEntriesByType("navigation");t.length>0&&(this.send("document_content_loaded",t[0].domContentLoadedEventEnd),this.send("document_load_time",t[0].loadEventEnd))}};var de;ue=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(v)),(0,t.Qj)(1,(0,e.WQ)(gt.O)),(0,t.Qj)(2,(0,e.WQ)(p.jf)),(0,t.Qj)(3,(0,e.MR)(l.V,l.O,"MetricReporterService")),(0,t.Sn)("design:paramtypes",["function"==typeof(re=void 0!==v&&v)?re:Object,"function"==typeof(se=void 0!==gt.O&&gt.O)?se:Object,"function"==typeof(ae="undefined"!=typeof Window&&Window)?ae:Object,"function"==typeof(ce=void 0!==l.V&&l.V)?ce:Object])],ue);let le=class{constructor(t){this.window=t}getItem(t){const e=this.window.sessionStorage.getItem(t);try{return JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;this.window.sessionStorage.setItem(t,n)}removeItem(t){return this.window.sessionStorage.removeItem(t)}};le=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(de="undefined"!=typeof Window&&Window)?de:Object])],le);var he,pe,fe,ge,ve,ye,me,we=o(248);let be=class{constructor(t,e,n,i,o,r,s){this.assetLoader=t,this.consentResolver=e,this.instantConfigService=n,this.coppaSubject=i,this.dataWarehouse=o,this.logger=r,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,t.sH)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(V.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(V.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var t;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const e=null===(t=this.instantConfigService.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t)}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:this.idConfigMapping.map((t=>t.id))})}trackIds(t){this.logger.info("resolve response:",t),Object.keys(t).forEach((e=>{if(!t[e])return;const n=this.getTrackingKeyName(e);if(this.isAvailableInStorage(n))return;"unifiedId"===e&&this.dataWarehouse.track(V.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const i=t[e];this.logger.info(`${e}: ${i}`),i&&(this.storage.setItem(n,i,this.storageConfig.ttl),this.dataWarehouse.track(V.i.identity,{partner_name:n,partner_identity_id:i}))}))}getTrackingKeyName(t){var e;return null===(e=this.idConfigMapping.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=e.kL.resolve(It):this.storage=e.kL.resolve(le)}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const n of this.storageConfig.mandatoryParams){const i=null===(t=this.idConfigMapping.find((t=>t.id===n)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(i)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}logEvent(t){this.metricReporter.send(t,1)}};var Ce,je,Oe;be=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(we.s)),(0,t.Qj)(1,(0,e.WQ)((0,e.cb)((()=>dt)))),(0,t.Qj)(2,(0,e.WQ)((0,e.cb)((()=>Qt)))),(0,t.Qj)(3,(0,e.WQ)(oe)),(0,t.Qj)(4,(0,e.WQ)(U.X)),(0,t.Qj)(5,(0,e.MR)(l.V,l.O,"liveConnect")),(0,t.Qj)(6,(0,e.WQ)(ue)),(0,t.Sn)("design:paramtypes",["function"==typeof(he=void 0!==we.s&&we.s)?he:Object,"function"==typeof(pe=void 0!==dt&&dt)?pe:Object,"function"==typeof(fe=void 0!==Qt&&Qt)?fe:Object,"function"==typeof(ge=void 0!==oe&&oe)?ge:Object,"function"==typeof(ve=void 0!==U.X&&U.X)?ve:Object,"function"==typeof(ye=void 0!==l.V&&l.V)?ye:Object,"function"==typeof(me=void 0!==ue&&ue)?me:Object])],be);let Se=class{constructor(t,e,n){this.logger=t,this.contextRepository=e,this.liveConnect=n}createPartnersContext(){this.contextRepository.set($.partners,"anyclip",{value:{ppid:this.contextRepository.get($.tracking,"ppid")}})}initializeTargetingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};var ke,Qe,Te,Ee;Se=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"Partners")),(0,t.Qj)(1,(0,e.WQ)(B)),(0,t.Qj)(2,(0,e.WQ)(be)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ce=void 0!==l.V&&l.V)?Ce:Object,"function"==typeof(je=void 0!==B&&B)?je:Object,"function"==typeof(Oe=void 0!==be&&be)?Oe:Object])],Se);let Ie=class{constructor(t,e,n,i){this.contextRepository=t,this.browser=e,this.coppaSubject=n,this.consentResolver=i}init(){return(0,t.sH)(this,void 0,void 0,(function*(){!this.coppaSubject.isCoppaSubject()&&this.consentResolver.getConsents()&&(this.setAdTargetingGroup(),this.setBrowser())}))}setBrowser(){this.contextRepository.set($.targeting,"browser",{value:this.browser.getBrowser().split(" ")[0]})}getRandomGroup(){return 5*Math.ceil(Math.random()%20*20)}setAdTargetingGroup(){const t=this.getRandomGroup(),e=Array.from({length:21},((t,e)=>100-5*e)).filter((e=>e>=t&&e>0));this.contextRepository.set($.targeting,"adGroup",{value:e.toString()})}};var Re,_e,Ae;Ie=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(B)),(0,t.Qj)(1,(0,e.WQ)(ft.P)),(0,t.Qj)(2,(0,e.WQ)(oe)),(0,t.Qj)(3,(0,e.WQ)(dt)),(0,t.Sn)("design:paramtypes",["function"==typeof(ke=void 0!==B&&B)?ke:Object,"function"==typeof(Qe=void 0!==ft.P&&ft.P)?Qe:Object,"function"==typeof(Te=void 0!==oe&&oe)?Te:Object,"function"==typeof(Ee=void 0!==dt&&dt)?Ee:Object])],Ie);let Pe=class{constructor(t,e,n){this.partnersService=t,this.adTargetingGroups=e,this.logger=n}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up targeting"),yield this.partnersService.initializeTargetingPartners(),yield this.adTargetingGroups.init()}))}};var We,Me,De,xe;Pe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Se)),(0,t.Qj)(1,(0,e.WQ)(Ie)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"TargetingService")),(0,t.Sn)("design:paramtypes",["function"==typeof(Re=void 0!==Se&&Se)?Re:Object,"function"==typeof(_e=void 0!==Ie&&Ie)?_e:Object,"function"==typeof(Ae=void 0!==l.V&&l.V)?Ae:Object])],Pe);let Ge=class{constructor(t,e,n,i){this.sentry=t,this.browser=e,this.device=n,this.platform=i,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get()})}};var Le,Ne;Ge=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.eF)),(0,t.Qj)(1,(0,e.WQ)(ft.P)),(0,t.Qj)(2,(0,e.WQ)(pt.p)),(0,t.Qj)(3,(0,e.WQ)(gt.O)),(0,t.Sn)("design:paramtypes",["function"==typeof(We=void 0!==ut&&ut)?We:Object,"function"==typeof(Me=void 0!==ft.P&&ft.P)?Me:Object,"function"==typeof(De=void 0!==pt.p&&pt.p)?De:Object,"function"==typeof(xe=void 0!==gt.O&&gt.O)?xe:Object])],Ge),o(606);let Ve=class{constructor(t,e){this.window=t,this.logger=e,this.queue=[]}install(){this.logger.info("installing consent queue");const t=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(e,n,i)=>t.push(e,n,i),this}push(t,e,n){this.logger.warn("dialog not resolved, enqueued:",t),this.queue.push({name:t,callback:e,category:n})}};Ve=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"ConsentCallbackQueue")),(0,t.Sn)("design:paramtypes",["function"==typeof(Le="undefined"!=typeof Window&&Window)?Le:Object,"function"==typeof(Ne=void 0!==l.V&&l.V)?Ne:Object])],Ve);var Ue=o(569);const He={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class Fe{constructor(t,e){this.container=t;const n=t.OptanonWrapper;t.OptanonWrapper=()=>{e.resolve(),null==n||n()}}available(){return void 0!==this.container.OneTrust}ready(){var t,e;const n=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&("opt-in"!==(null===(e=null===(t=n.GetDomainData())||void 0===t?void 0:t.ConsentModel)||void 0===e?void 0:e.Name)||n.IsAlertBoxClosed())}resolve(){var t;return null===(t=this.container.OnetrustActiveGroups)||void 0===t?void 0:t.split(",").map((t=>He[t])).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{})}}class $e{constructor(t,e){this.optIn=t,this.cookiesManager=e}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var t;const e=null===(t=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===t?void 0:t.match(/groups=([^&]+)/);return e&&e[1]?e[1].toUpperCase().split(",").map((t=>{const e=t.split(":");return"1"===e[1]?He[e[0]]:void 0})).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{}):{}}}var Be,qe,ze;const Ye={necessary:!0},Ke={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0};let Je=class{constructor(t,e,n){var i,o;this.container=t,this.logger=e,this.cookiesManager=n;const r=this.cookiesManager.get("Geo");this.queue=t.consentCallbackQueue,this.optIn=!!r&&Ue.e.includes(null===(o=null===(i=JSON.parse(decodeURIComponent(r)))||void 0===i?void 0:i.country)||void 0===o?void 0:o.toLowerCase()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new Fe(this.container,this),this.cookieConsentResolver=new $e(this.optIn,this.cookiesManager),this.resolve()||setTimeout((()=>this.resolveWithFallback()),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout((()=>this.resolveWithFallback),5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(t){const e=t.available();return e&&t.ready()&&(this.categories=t.resolve(),this.resolveQueue()),e}checkAndRun(t,e,n){return this.logger.info("About to callback:",t,"for:",n,"with:",this.categories),!(void 0!==n&&!this.categories[n]||(e(this.categories),0))}resolveQueue(){this.flushQueue(),this.queue.push=(t,e,n)=>this.checkAndRun(t,e,n),this.container.consentCallback=(t,e,n)=>this.checkAndRun(t,e,n)}flushQueue(){const t=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",t.length);for(let e=t.length-1;e>=0;e--){const n=t[e];this.checkAndRun(n.name,n.callback,n.category)&&t.splice(e,1)}}fallback(){return this.optIn?Ye:Ke}};var Xe,Ze,tn,en;Je=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"ConsentCallbackQueueHandler")),(0,t.Qj)(2,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(Be="undefined"!=typeof Window&&Window)?Be:Object,"function"==typeof(qe=void 0!==l.V&&l.V)?qe:Object,"function"==typeof(ze="undefined"!=typeof CookiesManager&&CookiesManager)?ze:Object])],Je);let nn=class{constructor(t,e,n,i){this.logger=t,this.windowContextRepository=e,this.dataWarehouse=n,this.navigator=i}init(){var e;return(0,t.sH)(this,void 0,void 0,(function*(){if(this.logger.info("FacilitatedTesting init"),null===(e=this.navigator.cookieDeprecationLabel)||void 0===e?void 0:e.getValue){const t=yield this.navigator.cookieDeprecationLabel.getValue();t?(this.logger.info(`Received cookieDeprecationLabel: ${t}`),this.windowContextRepository.set($.tracking,"chromeLabel",{value:t}),this.dataWarehouse.track(V.i.chromeLabel,t)):this.logger.info("Received empty cookieDeprecationLabel")}else this.logger.info("cookieDeprecationLabel not available")}))}};var on,rn;nn=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"GooglePrivacySandbox:FacilitatedTesting")),(0,t.Qj)(1,(0,e.WQ)(B)),(0,t.Qj)(2,(0,e.WQ)(U.X)),(0,t.Qj)(3,(0,e.WQ)(p.kW)),(0,t.Sn)("design:paramtypes",["function"==typeof(Xe=void 0!==l.V&&l.V)?Xe:Object,"function"==typeof(Ze=void 0!==B&&B)?Ze:Object,"function"==typeof(tn=void 0!==U.X&&U.X)?tn:Object,"function"==typeof(en="undefined"!=typeof Navigator&&Navigator)?en:Object])],nn);let sn=class{constructor(t,e){this.logger=t,this.facilitatedTesting=e}init(){this.logger.info("GooglePrivacySandbox init"),this.facilitatedTesting.init()}};var an,cn,un,dn,ln,hn,pn,fn,gn,vn,yn,mn,wn,bn,Cn,jn,On,Sn;sn=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"GooglePrivacySandbox")),(0,t.Qj)(1,(0,e.WQ)(nn)),(0,t.Sn)("design:paramtypes",["function"==typeof(on=void 0!==l.V&&l.V)?on:Object,"function"==typeof(rn=void 0!==nn&&nn)?rn:Object])],sn),e.kL.register(p.AZ,{useValue:i}),e.kL.register(p.kk,{useValue:function(t,e,n){if(r.randomUUID&&!e&&!t)return r.randomUUID();const i=(t=t||{}).random||(t.rng||c)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return function(t,e=0){return u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]}(i)}}),e.kL.register(p.jf,{useValue:window}),e.kL.register(p.kW,{useValue:navigator});let kn=class{constructor(t,e,n,i,o,r,s,a,c,u,d,l,h,p,f,g,v,y){this.geoCookie=t,this.ageGateHandler=e,this.communicationService=n,this.optInService=i,this.hemTrackingService=o,this.trackingContextSetupService=r,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=u,this.ppidProvider=d,this.coppaSubject=l,this.metricReporterService=h,this.partnersService=p,this.googlePrivacySandbox=f,this.targetingService=y}initializeAgeGateHandler(){return(0,t.sH)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(t){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:t.toString()})}initializeTracking(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),yield this.partnersService.createPartnersContext(),this.communicationService.emit(new R.r(_.c.IDENTITY_READY)),this.metricReporterService.send("ready"),this.googlePrivacySandbox.init()}))}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.targetingService.initializeTargeting()}))}init(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.send("init"),this.trackingContextSetupService.setup()}))}run(){this.logger.info("Starting identity engine v2.16.8"),this.communicationService.once(_.c.CONSENT_READY,(e=>{this.consentResolver.resolve(e,(()=>(0,t.sH)(this,void 0,void 0,(function*(){this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),this.initializeTargeting(),yield this.initializeTracking()}))),(()=>{this.updateGTMConsent(!1),this.initializeTargeting(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.communicationService.emit(new R.r(_.c.IDENTITY_READY)),this.metricReporterService.send("ready"),this.logger.info("Tracking rejected")}))}))}};kn=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(j)),(0,t.Qj)(1,(0,e.WQ)(M)),(0,t.Qj)(2,(0,e.WQ)(L.U)),(0,t.Qj)(3,(0,e.WQ)(N.E)),(0,t.Qj)(4,(0,e.WQ)(H)),(0,t.Qj)(5,(0,e.WQ)(st)),(0,t.Qj)(6,(0,e.WQ)(dt)),(0,t.Qj)(7,(0,e.WQ)(Qt)),(0,t.Qj)(8,(0,e.WQ)(p.jf)),(0,t.Qj)(9,(0,e.MR)(l.V,l.O,"IdentityEngine")),(0,t.Qj)(10,(0,e.WQ)(Zt)),(0,t.Qj)(11,(0,e.WQ)(oe)),(0,t.Qj)(12,(0,e.WQ)(ue)),(0,t.Qj)(13,(0,e.WQ)(Se)),(0,t.Qj)(14,(0,e.WQ)(sn)),(0,t.Qj)(15,(0,e.WQ)(Ve)),(0,t.Qj)(16,(0,e.WQ)(Je)),(0,t.Qj)(17,(0,e.WQ)(Pe)),(0,t.Sn)("design:paramtypes",["function"==typeof(an=void 0!==j&&j)?an:Object,"function"==typeof(cn=void 0!==M&&M)?cn:Object,"function"==typeof(un=void 0!==L.U&&L.U)?un:Object,"function"==typeof(dn=void 0!==N.E&&N.E)?dn:Object,"function"==typeof(ln=void 0!==H&&H)?ln:Object,"function"==typeof(hn=void 0!==st&&st)?hn:Object,"function"==typeof(pn=void 0!==dt&&dt)?pn:Object,"function"==typeof(fn=void 0!==Qt&&Qt)?fn:Object,"function"==typeof(gn="undefined"!=typeof Window&&Window)?gn:Object,"function"==typeof(vn=void 0!==l.V&&l.V)?vn:Object,"function"==typeof(yn=void 0!==Zt&&Zt)?yn:Object,"function"==typeof(mn=void 0!==oe&&oe)?mn:Object,"function"==typeof(wn=void 0!==ue&&ue)?wn:Object,"function"==typeof(bn=void 0!==Se&&Se)?bn:Object,"function"==typeof(Cn=void 0!==sn&&sn)?Cn:Object,"function"==typeof(jn=void 0!==Ve&&Ve)?jn:Object,"function"==typeof(On=void 0!==Je&&Je)?On:Object,"function"==typeof(Sn=void 0!==Pe&&Pe)?Sn:Object])],kn),function(){(0,t.sH)(this,void 0,void 0,(function*(){const t=function(){try{return"US"===e.kL.resolve(f.u).get().country?.01:.1}catch(t){return.01}}(),n=new ut({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:"2.16.8",environment:"production",sampleRate:t});try{e.kL.register(p.eF,{useValue:n}),e.kL.resolve(Ge);const t=e.kL.resolve(kn);yield t.init(),t.run()}catch(t){n.captureException(t)}}))}()})()})();
//# sourceMappingURL=index.js.map